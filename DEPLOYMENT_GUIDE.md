# Shami Restaurant API - Render Deployment Guide

## Overview
This guide will help you deploy your Laravel restaurant API to Render using Docker.

## Prerequisites
- GitHub repository with your code
- Render account (free tier available)
- Your Laravel application code in the `server/` directory

## Deployment Steps

### 1. Prepare Your Repository
Make sure your repository structure looks like this:
```
your-repo/
├── server/                 # Laravel application
│   ├── Dockerfile
│   ├── docker/
│   ├── app/
│   ├── database/
│   └── ...
├── render.yaml            # Render configuration
└── README.md
```

### 2. Update Repository URL
Edit `render.yaml` and update the repository URL:
```yaml
repo: https://github.com/YOUR_USERNAME/YOUR_REPO_NAME
```

### 3. Deploy to Render

#### Option A: Using Render Dashboard
1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New +" → "Web Service"
3. Connect your GitHub repository
4. Configure the service:
   - **Name**: `shami-restaurant-api`
   - **Environment**: `Docker`
   - **Dockerfile Path**: `./server/Dockerfile`
   - **Docker Context**: `./server`
   - **Plan**: `Starter` (recommended) or `Free`
   - **Region**: Choose closest to your users

#### Option B: Using render.yaml (Blueprints)
1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New +" → "Blueprint"
3. Connect your GitHub repository
4. Render will automatically detect and use your `render.yaml`

### 4. Environment Variables
The following environment variables are automatically configured:
- `APP_KEY`: Auto-generated by Render
- `APP_URL`: Auto-set to your service URL
- `DB_CONNECTION`: Set to `sqlite`
- `DB_DATABASE`: Set to `/var/www/storage/database/database.sqlite`
- `APP_ENV`: Set to `production`
- `APP_DEBUG`: Set to `false`

### 5. Database Setup
The application uses SQLite with the following features:
- **Automatic Migration**: Database tables are created on first deployment
- **Data Seeding**: Sample restaurant data is automatically loaded
- **Persistent Storage**: Database file is stored in Render's persistent disk

### 6. Health Check
The service includes a health check endpoint:
- **URL**: `https://your-app.onrender.com/api/menu/recommendations`
- **Purpose**: Ensures the application is running correctly

## Default Accounts

After deployment, you can use these test accounts:

### Admin Account
- **Email**: `admin@shami-restaurant.com`
- **Password**: `admin123`

### Manager Accounts
- **Email**: `manager1@shami-restaurant.com`
- **Password**: `manager123`
- **Email**: `mimoali@shami-restaurant.com`
- **Password**: `manager123`

### Customer Accounts
- **Email**: `ahmad.hamwi@customer.com`
- **Password**: `customer123`
- **Email**: `rana.kheir@customer.com`
- **Password**: `customer123`

## API Endpoints

Your deployed API will be available at:
- **Base URL**: `https://your-app.onrender.com`
- **API Documentation**: `https://your-app.onrender.com/api/menu/recommendations`

### Key Endpoints:
- `GET /api/menu/recommendations` - Menu recommendations
- `POST /api/auth/login` - User authentication
- `GET /api/dishes` - List all dishes
- `GET /api/categories` - List menu categories
- `POST /api/orders` - Create new order
- `GET /api/reservations` - List reservations

## Troubleshooting

### Common Issues:

1. **Build Fails**
   - Check that your `Dockerfile` is in the `server/` directory
   - Ensure all required files are committed to Git
   - Check Render build logs for specific errors

2. **Database Issues**
   - The SQLite database is automatically created
   - If data is missing, the seeder will run on first deployment
   - Check logs for migration errors

3. **Health Check Fails**
   - Ensure your API routes are properly configured
   - Check that the `/api/menu/recommendations` endpoint exists
   - Verify Laravel routes are cached

4. **Performance Issues**
   - Upgrade to a higher plan (Starter or higher)
   - Check application logs for errors
   - Monitor resource usage in Render dashboard

### Logs and Monitoring:
- View logs in Render dashboard under your service
- Monitor performance metrics
- Set up alerts for downtime

## Customization

### Adding Environment Variables:
1. Go to your service in Render dashboard
2. Navigate to "Environment" tab
3. Add custom variables as needed

### Updating the Application:
1. Push changes to your GitHub repository
2. Render will automatically redeploy
3. Monitor the deployment in the dashboard

## Security Notes

- Change default passwords after deployment
- Use HTTPS (automatically provided by Render)
- Keep your repository private if it contains sensitive data
- Regularly update dependencies

## Support

For issues with:
- **Render Platform**: Check [Render Documentation](https://render.com/docs)
- **Laravel Application**: Check application logs in Render dashboard
- **Docker Configuration**: Verify Dockerfile and docker directory setup

## Cost Optimization

- **Free Tier**: 750 hours/month, sleeps after 15 minutes of inactivity
- **Starter Plan**: $7/month, always-on, better performance
- **Higher Plans**: For production workloads with high traffic

Choose the plan that best fits your needs and budget.
